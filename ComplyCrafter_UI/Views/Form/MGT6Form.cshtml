<style>
    .textheader a {
        color: blue;
        text-decoration: none !important;
    }

    .textheader:hover a {
        color: red !important;
        cursor: pointer;
    }

    input {
        box-shadow: 0 0 11px 1px rgba(0, 0, 0, .05) !important;
    }

</style>

<div class="row m-auto" id="frm">
    <div class="card " style="flex-direction:row;">
        <div class=" col-lg-12">
            <div class="card-header ">
                <h3>
                    Form No.MGT-6
                </h3>
            </div>
            <div class="card-body" style="padding:0px 25px;">
                <p>
                    Return to the Registrar in respect of declaration under section 89 received by the company

                    [Pursuant to section 89(6) of The Companies Act, 2013 and pursuant to rule 9(3) of The Companies (Management and Administration) Rules, 2014]
                </p>
            </div>
            <div class="textheader my-4 mx-3">
                <a href="https://www.mca.gov.in/content/dam/mca-aem-forms/instructionkits/Instruction_Kit_MGT-6.pdf" target="_blank">

                    Refer instruction kit for filing the form

                </a>
            </div>
        </div>

    </div>

    <div class="content-wrapper">
        <div class="container-fluid">
            <main role="main" class="pb-3">
                <div class="row">
                    <div class="card">
                        <div class="card-header d-flex justify-content-between" style="padding: 15px 30px 10px;">
                            <ul class="nav nav-pills nav-fill p-1 bg-transparent" role="tablist">
                                <li class="nav-item">
                                    <a class="nav-link mb-0 px-4 py-1 active " href="javascript:;" role="part1" data-bs-toggle="tab">
                                        <span class="ms-1">
                                          Genreal Information
                                        </span>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link mb-0 px-4 py-1 " href="javascript:;" role="part2" data-bs-toggle="tab">
                                        <span class="ms-1">
                                            Registered Owners
                                        </span>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link mb-0 px-4 py-1 " href="javascript:;" role="part3" data-bs-toggle="tab">
                                        <span class="ms-1">
                                            Attachment & Declaration
                                        </span>
                                    </a>
                                </li>

                            </ul>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>
    <input type="hidden" class="num" value="0" name="id" />
    <input type="hidden" class="num" value="0" name="companyId" />


    <div id="part1" class="p-0">
<div class="card" style=" padding:20px;">
    <div class="row">
                <div class="d-flex justify-content-between mx-2 mb-2">
                    <p class="card-title mb-0" style="margin-top:1px; border-bottom:1px solid black;">
                        Company Details
                    </p>
                </div>

                <div class="col-md-6 my-2">
                    <label class="form-label">1 *Corporate Identity Number (CIN)</label>
                    <input type="text" placeholder="" class="form-control" value="" name="cin" style="box-shadow: 0 0 11px 1px rgba(0, 0, 0, .05);" disabled>
                    <div class="invalid-feedback"></div>
                </div>
                <div class="col-md-6 my-2">
                    <label class="form-label">1. (a) *Name of the Company</label>
                    <input type="text" placeholder="" class="form-control" value="" name="companyName" style="box-shadow: 0 0 11px 1px rgba(0, 0, 0, .05);" disabled>
                    <div class="invalid-feedback"></div>
                </div>

                <div class="col-lg-12 my-2">
                    <label class="form-label">(b) *Registered office address</label>
                    <input type="text" placeholder="SHOP NO 3 VERTEX VIKAS CHS LTD   WING A SIR M V RD BHD POLICE STN ANDHERI, MUMBAI, Mumbai City, Maharashtra, India, 400069" class="form-control" value="" name="companyAddress" style="box-shadow: 0 0 11px 1px rgba(0, 0, 0, .05);" disabled>
                    <div class="invalid-feedback"></div>
                </div>

                <div class="col-md-6 my-2">
                    <label class="form-label">(c) *email-id</label>
                    <input type="email" placeholder="akshaygraphics69@gmail.com" class="form-control" value="" name="companyEmail" style="box-shadow: 0 0 11px 1px rgba(0, 0, 0, .05);" disabled>
                    <div class="invalid-feedback"></div>
                </div>
                <div class="col-md-6 my-2">
                    <label class="form-label">2. *Number of Registered Owners for whom the form is being filed</label>
                    <input type="number" placeholder="" class="form-control num" value="" name="filedRegistered" id="ownerCount" style="box-shadow: 0 0 11px 1px rgba(0, 0, 0, .05);">

                    

                </div>
            </div>
</div>     

    </div>


    <div id="part2" class="p-0">
     
    </div>

    <div id="part3" class="p-0">
        <div class="card" style="padding:20px;"> 
            <div id="tab3" class="tab-pane animated  custon-tab-style1 active">
                <form action="" role="form" id="fupForm3" method="post" accept-charset="utf-8" enctype="multipart/form-data">
                    <div class="row mt-3" style="height: auto;">
                        <div class="col-xs-12 col-sm-5 col-md-5 form-row bold mt-3">(a) *Declaration by person referred to in section 89(1)</div>
                        <div class="col-xs-12 col-sm-3 col-md-3 form-row section89__hidden_class mt-3">
                            <input type="file" name="section89" id="section89" class="1" required="">
                        </div>
                    </div>
                    <div class="row mt-3" style="height: auto;">
                        <div class="col-xs-12 col-sm-5 col-md-5 form-row bold mt-3">(b) *Declaration by person referred to in section 89(2) or 89(3)</div>
                        <div class="col-xs-12 col-sm-3 col-md-3 form-row persondeclare__hidden_class mt-3">
                            <input type="file" name="personDeclare" id="persondeclare" class="1" required="">
                        </div>
                    </div>
                    <div class="row mt-3">
                        <div class="col-xs-12 col-sm-12 col-md-1 bold form-row mt-3" align="center">Sr. No</div>
                        <div class="col-xs-12 col-sm-12 col-md-10 bold form-row mt-3">(c) Optional Attachment(s) - if any</div>
                        <div class="col-xs-12 col-sm-12 col-md-1 form-row mt-3" align="center">
                            <button type="button" name="attachmentAdd" id="attachmentadd" class="btn btn-primary" style="padding:4px 6px !important;">
                                <i class="fa fa-plus" style="margin:0px !important;"></i>
                            </button>
                        </div>
                    </div>

                    <div id="equity8" class="mt-3">
                        <input type="hidden" name="l" id="l" value="1">
                        <div class="row mt-3" id="roweq1">
                            <div class="col-xs-12 col-sm-12 col-md-1 form-row" align="center">1.</div>
                            <div class="col-xs-12 col-sm-12 col-md-11 form-row d-flex align-items-center">
                                <input type="file" name="attachmentFile" id="attachmentfile_1" class="form-control" accept=".pdf,.xlsx">
                            </div>
                        </div>
                    </div>

                    <label style="font-weight:bolder;text-decoration: underline;margin: 0px -10px 5px;text-transform: uppercase;" class="mt-3">Declaration</label>
                    <div class="row" style="height: auto">
                        <div class="col-xs-12 col-sm-12 col-md-12 form-row" style="padding: 10px;height: auto;">
                            <p style="text-align: justify;line-height: 2em;">To the best of my knowledge and belief, the information given in this form and attachments is correct and complete. I have been authorised by the board of directors' resolution dated * &nbsp;
                                <input type="date" name="resolutionDate" id="resolutiondate" placeholder="" class="datepicker hasDatepicker" value="" required=""> &nbsp; to sign and submit this form.</p>
                        </div>
                    </div>
                    <div class="row" style="margin-bottom: 0px;">
                        <div class="col-xs-12 col-sm-4 col-md-4 bold" style="margin-left: -10px;">
                            *Designation
                        </div>
                        <div class="col-xs-12 col-sm-4 col-md-4 bold">
                            Signatory
                        </div>
                        <div class="col-xs-12 col-sm-4 col-md-4 bold" style="text-align: justify;">
                            DIN / PAN
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-xs-12 col-sm-4 col-md-4" style="margin-left: -10px;">
                            <select name="declarationDesignation" id="declarationDesignation" class="form-select" required="">
                                <option value=""> Select Designation</option>
                                <option value="Director">Director</option>
                                <option value="Manager">Manager</option>
                                <option value="Company Secretory">CEO</option>
                                <option value="CFO">CFO</option>
                                <option value="CEO">CFO</option>
                            </select>
                        </div>
                        <div class="col-xs-12 col-sm-4 col-md-4" id="change_designation">
                            <input type="text" name="declarationMembershipNo" id="declarationMembershipNo" class="form-control" value="" required=""></div>
                        <div class="col-xs-12 col-sm-4 col-md-4">
                            <input type="text" name="dinMemebers" id="DinMemebers" value="" class="form-control" required="" readonly="">
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>


    <div class="col-m-12 mt-3">
        <button class="btn btn-md btn-primary" style="float: right;" onclick="save(event)">
            Submit
        </button>
    </div>

</div>
<script>
$(document).ready(function () {
    let attachmentCount = 1;

    $('#attachmentadd').on('click', function () {
        attachmentCount++;
        $('#l').val(attachmentCount);

        const newRow = `
<div class="row mt-3" id="roweq${attachmentCount}">
    <div class="col-xs-12 col-sm-12 col-md-1 form-row" align="center">${attachmentCount}.</div>
    <div class="col-xs-12 col-sm-12 col-md-11 form-row d-flex align-items-center">
        <input type="file" name="attachmentFile" id="attachmentfile_${attachmentCount}" class="form-control" accept=".pdf,.xlsx">
        <button type="button" class="btn btn-danger ms-2 remove-attachment" data-id="${attachmentCount}" style="padding:4px 6px;">
            <i class="fa fa-minus"></i>
        </button>
    </div>
</div>
        `;
        $('#equity8').append(newRow);
    });

    // Delete attachment row
    $(document).on('click', '.remove-attachment', function () {
        const id = $(this).data('id');
        $('#roweq' + id).remove();
    });
});

</script>

@section Scripts {
    <script>

        var frm = {
            id: 0,
            companyId: 0,
            cin: "",
            companyName: "",
            companyAddress: "",
            companyEmail: "",

            // part-1
            filedRegistered: 0,

            // part-3
            section89: "",
            personDeclare: "",
            attachmentAdd: "",
            attachmentFile: "",
            resolutionDate: "",
            declarationDesignation: "",
            declarationMembershipNo: "",
            dinMemebers: "",
        };

        var voFrm = {
            id: 'required',
            companyId: 'required',
        };

        var vfFrm = null;

        $(document).ready(function () {

            // Tab toggle logic
            $("#part2").hide();
            $("#part3").hide();
            $('a[data-bs-toggle="tab"]').on('shown.bs.tab', function (e) {
                var active = $(e.target).attr('role');
                $("#part1").hide();
                $("#part2").hide();
                $("#part3").hide();
                $("#" + active).show();
            });

            // Attach ownerCount change listener
            $('#ownerCount').on('input', function () {
                const count = parseInt(this.value) || 0;
                const container = document.getElementById('part2');
                container.innerHTML = '';

                for (let i = 1; i <= count; i++) {
                    const section = document.createElement('div');
                    section.classList.add('owner-section');
                    section.innerHTML = generateOwnerForm(i);
                    container.appendChild(section);
                }

                // Show the container if count > 0
                if (count > 0) $("#part2").show();
            });

            load();
        });

        function save(event) {
            event.preventDefault();

            var obj = getObj(frm, '#frm');
            $._post(`@R.ApiUrl/@ViewBag.ctrl`, obj).then(x => {
                if (x.status) {
                    window.location = `@Url.Action("MGT6", "Form")`;
                } else {
                    Swal.fire({
                        icon: 'error',
                        title: 'Error',
                        text: x.message
                    });
                }
            });
        }

        function load() {
            if (@ViewBag.id > 0) {
                $._get(`@R.ApiUrl/@ViewBag.ctrl/${@ViewBag.id}`).then(x => {
                    frm = x;
                    setObj(x, "#frm");
                });
            }

            var company = localStorage.getItem("comp_id");
            if (!company || company === "0") {
                alert("Please select Company");
                window.location = `@Url.Action("MGT6", "Form")`;
                return;
            }

            $._get(`@R.ApiUrl/Company/${company}`).then(x => {
                $("[name='companyId']").val(x.id);
                $("[name='cin']").val(x.cin);
                $("[name='companyName']").val(x.companyName);
                $("[name='companyAddress']").val(x.address);
                $("[name='companyEmail']").val(x.email);
            });
        }

        function generateOwnerForm(index) {
            return `
            <div style="background-color: #fbe6e6; padding: 15px; margin-bottom: 25px; border: 1px solid #ccc; border-radius: 6px;">
                <h5 style="font-weight: bold;">Registered Owner #${index}</h5>

                <!-- SECTION 3: Share Particulars -->
                <div class="row">
                    <div class="col-md-4"><label>(a) *Number of Shares</label><input type="text" class="form-control" name="shares_${index}" required></div>
                    <div class="col-md-4"><label>(b) Distinctive Number (From)</label><input type="text" class="form-control" name="distinctFrom_${index}"></div>
                    <div class="col-md-4"><label>*Distinctive Number (To)</label><input type="text" class="form-control" name="distinctTo_${index}" required></div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-4"><label>(c) *Type of shares</label><input type="text" class="form-control" name="typeShares_${index}" required></div>
                    <div class="col-md-4"><label>*Class of shares</label><input type="text" class="form-control" name="classShares_${index}" required></div>
                    <div class="col-md-4"><label>(d) *Face value of shares</label><input type="text" class="form-control" name="faceValue_${index}" required></div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-6"><label>(e) *Paid up value of shares</label><input type="text" class="form-control" name="paidup_${index}" required></div>
                </div>

                <!-- SECTION 4: Registered Owner Details -->
                <hr>
                <h6><b>Details of the Registered Owner</b></h6>
                <div class="row">
                    <div class="col-md-6">
                        <label>(a) *ID Type</label>
                        <select class="form-control" name="idType_${index}" required>
                            <option value="">Select</option>
                            <option>Income Tax PAN</option>
                            <option>Passport Number</option>
                            <option>Other Registration Number</option>
                        </select>
                    </div>
                    <div class="col-md-6"><label>*ID Number</label><input type="text" class="form-control" name="idNumber_${index}" required></div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-4"><label>(b) *Name</label><input type="text" class="form-control" name="ownerName_${index}" required></div>
                    <div class="col-md-4"><label>(c) *Date of Birth</label><input type="date" class="form-control" name="dob_${index}" required></div>
                    <div class="col-md-4"><label>(d) *Nationality</label><select class="form-control" name="nationality_${index}" required><option value="">Select Country</option></select></div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-2"><label>*Code</label><input type="text" class="form-control" name="mobileCode_${index}" required></div>
                    <div class="col-md-4"><label>*Mobile</label><input type="text" class="form-control" name="mobile_${index}" required></div>
                    <div class="col-md-6"><label>(f) *Email ID</label><input type="email" class="form-control" name="email_${index}" required></div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-6"><label>*Address Line 1</label><input type="text" class="form-control" name="address1_${index}" required></div>
                    <div class="col-md-6"><label>Address Line 2</label><input type="text" class="form-control" name="address2_${index}"></div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-4"><label>*Pin Code</label><input type="text" class="form-control" name="pin_${index}" required></div>
                    <div class="col-md-4"><label>*Area/Locality</label><input type="text" class="form-control" name="area_${index}" required></div>
                    <div class="col-md-4"><label>*City</label><input type="text" class="form-control" name="city_${index}" required></div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-4"><label>District</label><input type="text" class="form-control" name="district_${index}"></div>
                    <div class="col-md-4"><label>*State/UT</label><input type="text" class="form-control" name="state_${index}" required></div>
                    <div class="col-md-4">
                        <label>*Father’s/Husband’s Name</label>
                        <select class="form-control" name="fatherHusband_${index}" required>
                            <option value="">Select</option>
                            <option>Father</option>
                            <option>Husband</option>
                        </select>
                    </div>
                </div>

                <!-- SECTION 5: Beneficial Owner Details -->
                <hr>
                <h6><b>Details of Beneficial Owner</b></h6>
                <div class="row">
                    <div class="col-md-4"><label>(a) *Whether BO ID is available?</label>
                        <select class="form-control" name="boIdAvailable_${index}" required>
                            <option value="">Select</option>
                            <option>Yes</option>
                            <option>No</option>
                        </select>
                    </div>
                    <div class="col-md-4"><label>(b) BO ID</label><input type="text" class="form-control" name="boId_${index}"></div>
                    <div class="col-md-4"><label>(c) *ID Type</label>
                        <select class="form-control" name="boIdType_${index}" required>
                            <option value="">Select</option>
                            <option>PAN</option>
                            <option>Passport</option>
                        </select>
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-6"><label>*Enter PAN/Passport Number</label><input type="text" class="form-control" name="boPan_${index}" required></div>
                    <div class="col-md-2 d-flex align-items-end">
                        <button type="button" class="btn btn-primary">Verify PAN</button>
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-4"><label>*Name of Beneficial Owner</label><input type="text" class="form-control" name="boName_${index}" required></div>
                    <div class="col-md-4"><label>*DOB</label><input type="date" class="form-control" name="boDob_${index}" required></div>
                    <div class="col-md-4"><label>*Nationality</label><select class="form-control" name="boNationality_${index}" required><option value="">Select Country</option></select></div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-6"><label>*Email ID</label><input type="email" class="form-control" name="boEmail_${index}" required></div>
                    <div class="col-md-6"><label>*Mobile</label><input type="text" class="form-control" name="boMobile_${index}" required></div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-6"><label>*Address Line 1</label><input type="text" class="form-control" name="boAddress1_${index}" required></div>
                    <div class="col-md-6"><label>Address Line 2</label><input type="text" class="form-control" name="boAddress2_${index}"></div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-4"><label>*Pin Code</label><input type="text" class="form-control" name="boPin_${index}" required></div>
                    <div class="col-md-4"><label>*Area/Locality</label><input type="text" class="form-control" name="boArea_${index}" required></div>
                    <div class="col-md-4"><label>*City</label><input type="text" class="form-control" name="boCity_${index}" required></div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-4"><label>*State</label><input type="text" class="form-control" name="boState_${index}" required></div>
                    <div class="col-md-4"><label>*Country</label><select class="form-control" name="boCountry_${index}" required><option value="">Select Country</option></select></div>
                    <div class="col-md-4"><label>*Father’s/Husband’s Name</label><input type="text" class="form-control" name="boFather_${index}" required></div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-6"><label>*Date of Declaration</label><input type="date" class="form-control" name="boDeclDate_${index}" required></div>
                    <div class="col-md-6"><label>*Date of Receipt</label><input type="date" class="form-control" name="boReceiptDate_${index}" required></div>
                </div>
            </div>`;
        }

    </script>
}
