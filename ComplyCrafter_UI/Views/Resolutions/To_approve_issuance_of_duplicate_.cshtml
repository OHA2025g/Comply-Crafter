@{
    Layout = ViewBag.UseLayout == false ? null : "_Layout";
}
<script id="resolnMain">
    let mode = '@ViewBag.Mode';
    let meeting = @ViewBag.Meeting;
    let resolnId = @ViewBag.ResolnId;
    let isLayOut = Boolean('@(ViewBag.UseLayout == false ? "" : "_Layout")');
    let R_ApiUrl = '@R.ApiUrl';

    let agendaOption = `To approve issuance of duplicate {share certificate}`;
    let agendaHeading = `To approve issuance of duplicate {share certificate}`;
    let minuteHeading = `Issuance of duplicate share certificates`;
    let agendaPreface = `
    The Company has received applications from existing shareholders for the issuance of duplicate share certificates in lieu of original certificates which are reported to have been lost and not traceable. The Board will review the matter and if the request is found in order, the following resolution may be passed in this regard:
                    `;
    let minutePreface = `
    The Company had received applications from existing shareholders for the issuance of duplicate share certificates in lieu of original certificates which are reported to have been lost and not traceable. The Board reviewed the matter, and the passed the following resolution:
     `;
    let resolutionForNoticePara1 = `
    “RESOLVED THAT pursuant to provisions of Companies Act, 2013, (including any statutory modification or re-enactment thereof for the time being in force) read with the Companies (Share Capital and Debentures) Rules, 2014, the consent of the Board of Directors ("the Board") of the Company be and is hereby accorded to the issuance of duplicate share certificates in lieu of original certificates reported to have been lost and not traceable in respect of following share certificates.

            `;
    let resolutionForNoticePara2 = `
    RESOLVED FURTHER THAT the Duplicate Share Certificates be issued and that {Name of Director}, {Designation} {and Name of Director2 Designation2}, Directors of the Company and {Name of Authorized Signatory}, Authorized Signatory of the Company, be and are hereby authorized to sign the duplicate share certificates and that the Common Seal of the Company, if any, be affixed on the Share Certificates in their presence.

    RESOLVED FURTHER THAT any of the directors of the Company, be and are hereby authorized to take necessary steps for the issuance of duplicate share certificates and further to do all such acts, deeds and things as may be considered necessary in this regard including updating the Statutory Registers of the Company.

    RESOLVED FURTHER THAT a certified copy of this resolution signed by any of the Directors be provided to anyone concerned or interested in the matter."
    `;
    let resolutionForMinutesPara1 = `
    “RESOLVED THAT pursuant to provisions of Companies Act, 2013, (including any statutory modification or re-enactment thereof for the time being in force) read with the Companies (Share Capital and Debentures) Rules, 2014, the consent of the Board of Directors ("the Board") of the Company be and is hereby accorded to the issuance of duplicate share certificates in lieu of original certificates reported to have been lost and not traceable in respect of following share certificates.
            `;
    let resolutionForMinutesPara2 = `
    RESOLVED FURTHER THAT the Duplicate Share Certificates be issued and that {Name of Director}, {Designation} {and Name of Director2 Designation2}, Directors of the Company and {Name of Authorized Signatory}, Authorized Signatory of the Company, be and are hereby authorized to sign the duplicate share certificates and that the Common Seal of the Company, if any, be affixed on the Share Certificates in their presence.

    RESOLVED FURTHER THAT any of the directors of the Company, be and are hereby authorized to take necessary steps for the issuance of duplicate share certificates and further to do all such acts, deeds and things as may be considered necessary in this regard including updating the Statutory Registers of the Company.

    RESOLVED FURTHER THAT a certified copy of this resolution signed by any of the Directors be provided to anyone concerned or interested in the matter."
    `;
</script>
<style>
    .table-bordered-custom {
        border-collapse: collapse;
        width: 100%;
    }

        .table-bordered-custom th,
        .table-bordered-custom td {
            border: 1px solid black;
            padding: 6px;
            text-align: center;
        }
</style>
<style>
    .custom-table .form-control {
        height: 28px;
        padding: 2px 6px;
        font-size: 13px;
    }

    /* Keep table borders clean and aligned */
    .custom-table td, .custom-table th {
        border: 1px solid #000 !important;
        vertical-align: middle;
        padding: 4px 6px;
    }

    /* Make the heading row subtle */
    .custom-table .table-title {
        background-color: #f1f1f1;
        font-weight: bold;
        padding: 6px;
    }

    /* Adjust small button size */
    .custom-table .btn-sm {
        padding: 1px 6px;
        font-size: 12px;
        line-height: 1.2;
    }
</style>



<div class="@(ViewBag.UseLayout == true ? "card p-4 shadow-sm mt-3" : "")">

    @if (ViewBag.UseLayout == true)
    {
        <table class="custom-table">
            <tbody>
                <tr>
                    <td><strong>Share Type</strong></td>
                    <td>
                        <select class="form-control" name="shareType">
                            <option value="">Select</option>
                            <option>Equity</option>
                            <option>Preference</option>
                            <option>Debentures</option>
                        </select>
                    </td>
                    <td><strong>Number of Shares</strong></td>
                    <td>
                        <input type="number" class="form-control num" name="numberOfShares" placeholder="Enter quantity">
                    </td>
                </tr>

                <tr>
                    <td colspan="4" class="table-title">Authorization For Resolution</td>
                </tr>

                <tr class="authorizedRow">
                    <td><strong>Name of Authorized Person</strong></td>
                    <td>
                        <select class="form-control director" name="appointedDirector">
                            <option value="">Select name</option>
                        </select>
                    </td>
                    <td colspan="2" class="text-center">
                        <input type="hidden" name="id" class="num" value="0">
                        <button type="button" class="btn btn-primary btn-sm" onclick="addAuthorizedRow()">+</button>
                    </td>
                </tr>
            </tbody>
        </table>
    }

    @if (ViewBag.UseLayout == true)
    {
        <h4 class="mb-4 border-bottom pb-2 mt-4">Agenda Details</h4>
    }

    <form id="frmAgenda">

        @*  <div class="row mb-3">
            <div class="col-md-3 fw-bold">
                Category
            </div>
            <div class="col-md-9">
                <select name="category" class="form-control">
                    <option>Share Capital</option>
                </select>
            </div>
        </div>

        <div class="row mb-3">
            <div class="col-md-3 fw-bold">
                Sub Category
            </div>
            <div class="col-md-9">
                <select name="subCategory" class="form-control">
                    <option>Share Certificates</option>
                </select>
            </div>
            </div> *@

        @await Html.PartialAsync("SharedResolutionView/_AgendaDetails",
                 new AgendaViewModelEnabler()
                    {
                        enableNoticeCertificateTable = false,
                        enableMinutesCertificateTable = false,
                    }
                 )
        @await Html.PartialAsync("SharedResolutionView/_ResolutionSignDetails")
        @await Html.PartialAsync("SharedResolutionView/_ResolutionSaveButton")
    </form>
</div>

<script id="resolnFunction">
    function addAuthorizedRow() {
        let table = document.querySelector('.custom-table tbody');
        if (!table) return;
        let newRow = document.createElement('tr');
        newRow.classList.add('authorizedRow');
        if (isLayOut)
        {
            newRow.innerHTML = `
                <td><strong>Name of Authorized Person</strong></td>
                <td>
                    <select class="form-control director" name="appointedDirector">
                        <option value="">Select name</option>
                        ${directorsOptionHTMLAgenda}
                    </select>
                </td>
                <td colspan="2" class="text-center">
                    <input type="hidden" name="id" class="num" value="0">
                    <button type="button" class="btn btn-danger btn-sm" onclick="removeAuthorizedRow(this)">-</button>
                </td>
            `;
        }
        else
        {
            newRow.innerHTML = `
                <td><strong>Name of Authorized Person</strong></td>
                <td colspan="3">
                    <p name="appointedDirector"></p>
                </td>
            `;
        }

        table.appendChild(newRow);
    }

    function removeAuthorizedRow(button) {
        button.closest('tr').remove();
    }

    function resetTableAuthorized() {
        if (!isLayOut) return;

        $('.authorizedRow').remove();
        $('.custom-table tbody').append(`
            <tr class="authorizedRow">
                <td><strong>Name of Authorized Person</strong></td>
                <td>
                    <select class="form-control director" name="appointedDirector">
                        <option value="">Select name</option>
                        ${directorsOptionHTMLAgenda}
                    </select>
                </td>
                <td colspan="2" class="text-center">
                    <input type="hidden" name="id" class="num" value="0">
                    <button type="button" class="btn btn-primary btn-sm" onclick="addAuthorizedRow()">+</button>
                </td>
            </tr>
        `);
    }
</script>
<script src="~/js/resolutions/commonresolutionscript.js"></script>