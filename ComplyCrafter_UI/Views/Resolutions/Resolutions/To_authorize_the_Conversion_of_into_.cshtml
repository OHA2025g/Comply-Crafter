@{
    ViewData["Title"] = "To authorize the Conversion of Debentures Form";
}

<style>
    .custom-table {
        border-collapse: collapse;
        width: 100%;
        margin-bottom: 20px;
        table-layout: fixed;
    }

        .custom-table td, .custom-table th {
            border: 1px solid #ccc;
            padding: 8px;
            vertical-align: middle;
        }

        .custom-table th {
            background: #f8f9fa;
            font-weight: 600;
            text-align: center;
        }

    .form-control, .form-select {
        width: 100%;
        padding: 6px;
        box-sizing: border-box;
    }

    .btn-custom {
        background-color: #2269f5;
        color: #fff;
        border-radius: 6px;
        padding: 6px 16px;
        border: none;
    }

        .btn-custom:hover {
            background-color: #1b56c2;
        }

    .section-heading {
        background: #f8f9fa;
        font-weight: 600;
        text-align: center;
        padding: 6px;
        border: 1px solid #ccc;
        margin-bottom: -1px;
    }
</style>

<div class="card shadow-sm p-4">
    <h4 class="text-primary mb-3">To authorize the Conversion of Debentures Form</h4>



        <!-- ====================== MANAGING DIRECTOR & SIGNATORY ====================== -->
        <div class="section-heading">DIRECTOR & SIGNATORY DETAILS</div>
        <div class="p-3 border">
            <div class="row mb-3">
                <div class="col-md-6">
                    <label class="form-label"><strong>Name of the Managing Director</strong></label>
                    <select class="form-select" name="ManagingDirectorName">
                        <option value="">Select Managing Director</option>
                        <option>Director 1</option>
                        <option>Director 2</option>
                    </select>
                </div>
                <div class="col-md-6">
                    <label class="form-label"><strong>Name of the Authorized Signatory</strong></label>
                    <select class="form-select" name="AuthorizedSignatory">
                        <option value="">Select Director</option>
                        <option>John Doe</option>
                        <option>Jane Smith</option>
                    </select>
                </div>
            </div>
        </div>

      
    

















       




        <!-- ====================== AGENDA & RESOLUTION ====================== -->
        <h4 class="mb-4 border-bottom pb-2 mt-4">Agenda Details</h4>
        <div class="p-3 border">
            <div class="row mb-3">
                <div class="col-md-3 fw-bold">Agenda</div>
                <div class="col-md-9">
                    <select name="agenda" class="form-control">
                    <option>To authorize the Conversion of {Debentures} into {Shares}</option>
                    </select>
                </div>
            </div>

            <div class="row mb-3">
                <div class="col-md-3 fw-bold">Agenda Heading <span class="text-danger">*</span></div>
                <div class="col-md-9">
                <input type="text" class="form-control" value="To authorize the Conversion of {Debentures} into {Shares}">
                </div>
            </div>

            <div class="row mb-3">
                <div class="col-md-3 fw-bold">Minute Heading <span class="text-danger">*</span></div>
                <div class="col-md-9">
                <input type="text" class="form-control" value="To authorize the Conversion of {Debentures} into {Shares}">
                </div>
            </div>

            <div class="row mb-3">
                <div class="col-md-3 fw-bold">Agenda Preface</div>
                <div class="col-md-9">
                    <textarea rows="6" class="form-control">
To issue and allot shares as envisaged in the scheme of arrangement / merger / demerger approved by Hon’ble NCLT, {NCLT Bench}
</textarea>
                </div>
            </div>

            <div class="row mb-3">
                <div class="col-md-3 fw-bold">Minute Preface</div>
                <div class="col-md-9">
                    <textarea rows="6" class="form-control">
To issue and allot shares as envisaged in the scheme of arrangement / merger / demerger approved by Hon’ble NCLT, {NCLT Bench}
</textarea>
                </div>
            </div>

            <div class="row mb-3">
                <div class="col-md-3 fw-bold">Resolution for Notice</div>
                <div class="col-md-9">
                    <textarea rows="6" class="form-control">[Resolution for Notice text here]</textarea>
                </div>
            </div>

            <div class="row mb-3">
                <div class="col-md-3 fw-bold">Resolution for Minutes</div>
                <div class="col-md-9">
                    <textarea rows="12" class="form-control">[Resolution for Minutes text here]</textarea>
                </div>
            </div>
        </div>

        <!-- ====================== SIGNATORY TABLE ====================== -->
        <div class="section-heading">RESOLUTION SIGNATORY DETAILS</div>
        <div class="p-3 border">
            <table class="table table-bordered table-sm align-middle" id="signatoryTable">
                <thead class="table-light">
                    <tr>
                        <th>Sr. No.</th>
                        <th>Name of Signatory</th>
                        <th>DIN / PAN</th>
                        <th>Date of Signing</th>
                        <th style="width: 80px; text-align:center;">Action</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>1</td>
                        <td>
                            <select class="form-select">
                                <option value="">Select Signatory</option>
                                <option>John Doe</option>
                                <option>Jane Smith</option>
                                <option>Michael Johnson</option>
                                <option>Emily Davis</option>
                            </select>
                        </td>
                        <td><input type="text" class="form-control" placeholder="Enter DIN / PAN"></td>
                        <td><input type="date" class="form-control"></td>
                        <td style="text-align:center;">
                            <button type="button" class="btn btn-primary btn-sm" onclick="addSignatoryRow()">+</button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- ====================== SUBMIT ====================== -->
        <div class="row mt-4">
            <div class="col text-end">
                <button type="submit" class="btn btn-primary px-4 py-2">Submit</button>
            </div>
        </div>

</div>



<script>
    $(document).ready(function () {
        $('input[name="FullyPaid"]').change(function () {
            if ($(this).val() === "No") {
                $('#amountPaidRow').show();
            } else {
                $('#amountPaidRow').hide();
                $('#amountPaidRow input').val("");
            }
        });
    });
</script>









<script>
    document.addEventListener("DOMContentLoaded", function () {
        // Toggle Board/Circular sections
        document.querySelectorAll("input[name='approvalMode']").forEach(radio => {
            radio.addEventListener("change", function () {
                document.getElementById("approvalBoardSection").classList.toggle("d-none", this.value !== "board");
                document.getElementById("approvalCircularSection").classList.toggle("d-none", this.value !== "circular");
            });
        });

        // Toggle YES/NO inside Board section
        document.querySelectorAll("input[name='approvalIncorporate']").forEach(radio => {
            radio.addEventListener("change", function () {
                document.getElementById("approvalYes").classList.toggle("d-none", this.value !== "yes");
                document.getElementById("approvalNo").classList.toggle("d-none", this.value !== "no");
            });
        });
    });
</script>
<script>
    (function() {
      const container = document.getElementById('allotteeContainer');
      const addBtn = document.getElementById('addAllotteeBtn');
      let allotteeCount = 0;

      // Add an allottee block
      function addAllottee() {
        allotteeCount++;
        const block = document.createElement('div');
        block.className = 'allotment-block mb-3';
        block.setAttribute('data-id', allotteeCount);

        block.innerHTML = `
          <div class="row mb-1">
            <div class="col-12">
              <span class="allotment-title fw-bold text-decoration-underline">${allotteeCount} Allotment</span>
            </div>
          </div>

          <div class="row align-items-center">
            <div class="col-md-6">
              <select class="form-control" name="ShareholderName${allotteeCount}">
                <option value="">Select Shareholder Name</option>
                <option value="shareholder1">Shareholder 1</option>
                <option value="shareholder2">Shareholder 2</option>
                <option value="shareholder3">Shareholder 3</option>
              </select>
            </div>

            <div class="col-md-3">
              <input type="number" class="form-control" name="Quantity${allotteeCount}" placeholder="Enter Quantity" />
            </div>



            <div class="col-md-1 text-end">
              <button type="button" class="btn btn-danger btn-sm remove-allottee">X</button>
            </div>
          </div>
        `;

        container.appendChild(block);
      }

      // Re-number titles and input names after add/remove
      function updateAllotteeLabels() {
        const blocks = container.querySelectorAll('.allotment-block');
        allotteeCount = 0;
        blocks.forEach((blk, idx) => {
          const newIndex = idx + 1;
          allotteeCount = newIndex;
          blk.setAttribute('data-id', newIndex);

          // Update title
          const title = blk.querySelector('.allotment-title');
          if (title) title.textContent = `${newIndex} Allotment`;

          // Update form field names
          blk.querySelector('select').setAttribute('name', `ShareholderName${newIndex}`);
          blk.querySelectorAll('input')[0].setAttribute('name', `Quantity${newIndex}`);
          blk.querySelectorAll('input')[1].setAttribute('name', `LoanAmount${newIndex}`);
        });
      }

      // Add button event
      addBtn.addEventListener('click', function (e) {
        e.preventDefault();
        addAllottee();
        updateAllotteeLabels();
      });

      // Remove allottee (event delegation)
      container.addEventListener('click', function (e) {
        if (e.target.classList.contains('remove-allottee')) {
          e.target.closest('.allotment-block').remove();
          updateAllotteeLabels();
        }
      });

      // Submit handler (optional, logs data)
      document.getElementById('submitAllottees').addEventListener('click', function () {
        const data = [];
        const blocks = container.querySelectorAll('.allotment-block');
        blocks.forEach((blk, idx) => {
          const i = idx + 1;
          data.push({
            index: i,
            name: blk.querySelector(`select[name="ShareholderName${i}"]`)?.value || '',
            qty: blk.querySelector(`input[name="Quantity${i}"]`)?.value || '',
            loan: blk.querySelector(`input[name="LoanAmount${i}"]`)?.value || ''
          });
        });
        console.log('Allottees:', data);
      });
    })();
</script>


<script>
    (function () {
        const tableBody = document.getElementById('allotteeTableBody');
        const addRowBtn = document.getElementById('addRowBtn');
        const clearTableBtn = document.getElementById('clearTableBtn');
        let rowCount = 0;

        // Add new row
        function addRow() {
            rowCount++;
            const row = document.createElement('tr');

            row.innerHTML = `
                <td class="text-center">${rowCount}</td>
                <td><input type="text" class="form-control" name="ShareholderName${rowCount}" placeholder="Enter Name"></td>
                <td>
                    <select class="form-select" name="Status${rowCount}">
                        <option value="">Select</option>
                        <option>Active</option>
                        <option>Inactive</option>
                    </select>
                </td>
                <td><input type="text" class="form-control" name="Category${rowCount}" placeholder="Category"></td>
                <td><input type="text" class="form-control" name="SubCategory${rowCount}" placeholder="Sub Category"></td>
                <td><input type="text" class="form-control" name="SubSubCategory${rowCount}" placeholder="Sub Sub Category"></td>
                <td><input type="text" class="form-control" name="NewStatus${rowCount}" placeholder="New Status"></td>
            `;

            tableBody.appendChild(row);
        }

        // Clear all rows
        function clearTable() {
            tableBody.innerHTML = '';
            rowCount = 0;
        }

        // Event listeners
        addRowBtn.addEventListener('click', addRow);
        clearTableBtn.addEventListener('click', clearTable);
    })();
</script>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        // Board Meeting toggle
        document.querySelectorAll("input[name='boardMeetingIncorporate']").forEach(radio => {
            radio.addEventListener("change", function() {
                document.getElementById("boardMeetingYes").classList.toggle("d-none", this.value !== "yes");
                document.getElementById("boardMeetingNo").classList.toggle("d-none", this.value !== "no");
            });
        });

        // General Meeting toggle
        document.querySelectorAll("input[name='generalMeetingIncorporate']").forEach(radio => {
            radio.addEventListener("change", function() {
                document.getElementById("generalMeetingYes").classList.toggle("d-none", this.value !== "yes");
                document.getElementById("generalMeetingNo").classList.toggle("d-none", this.value !== "no");
            });
        });

        // Approval for allotment toggle
        document.querySelectorAll("input[name='approvalIncorporate']").forEach(radio => {
            radio.addEventListener("change", function() {
                document.getElementById("approvalYes").classList.toggle("d-none", this.value !== "yes");
                document.getElementById("approvalNo").classList.toggle("d-none", this.value !== "no");
            });
        });
    });
</script>

                